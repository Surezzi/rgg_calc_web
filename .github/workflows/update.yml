name: üéØ –ü–∞—Ä—Å–µ—Ä —à–∞—à–µ–∫

on:
  workflow_dispatch:
  schedule:
    - cron: '0 */2 * * *'

permissions:
  contents: write

jobs:
  parse:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    
    - name: Install dependencies
      run: pip install requests beautifulsoup4
    
    - name: Run parser
      run: python scripts/parser.py
      
     - name: Debug
      run: |
        echo "=== –ü–†–û–í–ï–†–ö–ê –§–ê–ô–õ–û–í ==="
        ls -la
        echo "--- –ü–∞–ø–∫–∞ data:"
        ls -la data/ 2>/dev/null || echo "–ü–∞–ø–∫–∞ data –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
        echo "--- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ out.json:"
        if [ -f "data/out.json" ]; then
          cat data/out.json | head -20
        else
          echo "–§–∞–π–ª data/out.json –Ω–µ –Ω–∞–π–¥–µ–Ω!"
        fi
        
    - name: Auto commit and push
      uses: stefanzweifel/git-auto-commit-action@v4
      with:
        commit_message: "ü§ñ Auto-update data"
        file_pattern: data/*
        commit_user_name: github-actions[bot]
        commit_user_email: github-actions[bot]@users.noreply.github.com
